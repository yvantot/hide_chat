storage.get(null,(e=>{makeHideInject(e.messengerChats,"hidechat-hidden"),obfRuleInject(),obfRuleModifyAttr(),obfInject(e.preferences.obfMethod.text,e.preferences.obfMethod.image,e.preferences.obfMethod.blurIntensity,e.preferences.obfMethod.brightnessIntensity),makeObfInject(e.messengerChats);const t=e.messengerChats.filter((e=>e.isPinned));pinChats(t,`background-color: ${hexToRgb(e.preferences.pinnedColor)} !important;`),lockedUICSS(),makeLockedInject(e)})),chrome.storage.onChanged.addListener((()=>{storage.get(null,(e=>{makeHideInject(e.messengerChats,"hidechat-hidden");const t=e.messengerChats.filter((e=>e.isPinned));pinChats(t,`background-color: ${hexToRgb(e.preferences.pinnedColor)} !important;`),makeLockedInject(e),obfInject(e.preferences.obfMethod.text,e.preferences.obfMethod.image,e.preferences.obfMethod.blurIntensity,e.preferences.obfMethod.brightnessIntensity),makeObfInject(e.messengerChats)}))})),onUrlChanged((()=>{isMessenger=location.origin.includes("https://www.messenger.com")||location.href.includes("https://www.facebook.com/messages"),isFacebook=location.origin.includes("https://www.facebook.com"),storage.get(null,(e=>{makeLockedInject(e),makeObfInject(e.messengerChats);const t=e.messengerChats.filter((e=>e.isPinned));pinChats(t,`background-color: ${hexToRgb(e.preferences.pinnedColor)} !important;`)}))})),chrome.runtime.onMessage.addListener(((e,t,n)=>{switch(e.message){case"getThisChat":return n(getChatInfo(getChatByUrl(e.clickedChat))),!0;case"getAllChat":return n(getAllChat()),!0;case"toggleHiddenAll":storage.get(null,(e=>{toggleHide(e.messengerChats,"hidechat-hiddentoggle")}));break;default:break}}));