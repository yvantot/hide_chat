let pinInterval,pinTimeout,pinObserver;function pinChats(e,t){const n=new Set(e.map((e=>e.chatURL)));function r(){const r=getPinnedNodes(e),i=document.querySelector(SELECTORS.CHATCONTAINER);if(!i)return;const o=i?.children;for(let e=0;e<o.length;e++){const r=o[e].querySelector(SELECTORS.CHATLINK);if(r){const e=getChatId(r.href);if(n.has(e))r.setAttribute("style",t);else{const e=r.getAttribute("style");e?r.setAttribute("style",e.replace(t,"")):r.removeAttribute("style")}}}for(let e=0;e<r.length;e++){const t=o[e].querySelector(SELECTORS.CHATLINK),s=getChatId(t.href);if(t){if(n.has(s))continue;r.forEach((e=>i.insertBefore(e,i.firstChild)))}}}function i(){isMessenger?(pinInterval&&clearInterval(pinInterval),pinTimeout&&clearTimeout(pinTimeout),pinInterval=setInterval((()=>{r()}),500),pinTimeout=setTimeout((()=>{pinInterval&&clearInterval(pinInterval),onOrderChange((()=>{r()})),pinObserver||i()}),1e4)):(pinInterval&&clearInterval(pinInterval),pinTimeout&&clearTimeout(pinTimeout),pinInterval=setInterval((()=>{r()}),500))}whenAvail((()=>document.querySelector(SELECTORS.CHATCONTAINER)),(()=>i()))}function getPinnedNodes(e){const t=document.querySelector(SELECTORS.CHATCONTAINER),n=[];return e.forEach((e=>{let r=t.querySelector(`a[href='${isFacebook?"/messages":""}${e.chatURL}']`);r&&(r=r?.closest(SELECTORS.VIRTUALIZED),n.push(r))})),n}function onOrderChange(e){const t=document.querySelector(`${SELECTORS.CHATCONTAINER} ${SELECTORS.MESSAGECONTAINER}`);t&&(pinObserver&&pinObserver.disconnect(),pinObserver=new MutationObserver((()=>e())),pinObserver.observe(t,{childList:!0}))}