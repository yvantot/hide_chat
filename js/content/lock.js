let lockInterval,unlockedChats=new Set;function makeLockedInject(t){const e=new Set(t.messengerChats.filter((t=>t.isLocked)).map((t=>t.chatURL)));lockInterval&&clearInterval(lockInterval),lockInterval=setInterval((()=>{if(e.has(getCurrentChat())){if(unlockedChats.has(getCurrentChat()))return;lockChat(t)}else unlockChat()}),1e3)}function setPassword(t){for(;!t.preferences.userPassword||t.preferences.userPassword.length<5;){let e=t.preferences.userPassword;e&&""!==e?e.length<5&&(e=prompt(`Your current password is '${e}'. The password must be at least 5 characters long:`)):e=prompt("You haven't set a password yet. Please create one to lock this chat. The password must be at least 5 characters long:"),e&&e.length>=5?(alert("Your password is: "+e),t.preferences.userPassword=e,storage.set(t)):alert("The password must be at least 5 characters long. Please try again.")}}function lockChat(t){if(setPassword(t),document.getElementById("hc-lockedmain"))return;const e=document.querySelector(SELECTORS.INBOXDETAIL),n=document.querySelector(SELECTORS.MESSAGECONTAINER),o=document.querySelector(SELECTORS.INBOXDETAILRIGHT);n?.setAttribute("style","display: none !important;"),o?.setAttribute("style","display: none !important;");const r=lockedUIHTML();e?.setAttribute("style","position: relative !important;"),e?.insertBefore(r,e.firstChild);const a=r.querySelector("#hc-unlockpass"),c=r.querySelector("#hc-lockedpass");c?.focus(),a?.addEventListener("click",(()=>{c.value.trim()===t.preferences.userPassword.trim()&&(unlockChat(),unlockedChats.add(getCurrentChat()))})),c?.addEventListener("keydown",(e=>{"Enter"===e.key&&c.value.trim()===t.preferences.userPassword.trim()&&(unlockChat(),unlockedChats.add(getCurrentChat()))}))}function unlockChat(){document.getElementById("hc-lockedmain")&&(document.getElementById("hc-lockedmain")?.remove(),document.querySelector(SELECTORS.INBOXDETAIL)?.removeAttribute("style"),document.querySelector(SELECTORS.MESSAGECONTAINER)?.removeAttribute("style"),document.querySelector(SELECTORS.INBOXDETAILRIGHT)?.removeAttribute("style"))}function lockedUICSS(){const t=document.createElement("style");t.setAttribute("id","hidechat-lockedchat"),t.innerHTML="\n\t\t#hc-lockedmain {\n\t\t\tposition: absolute;\n\t\t\tinset: 0;\n\t\t\tz-index: 214748364;\n\t\t\tfont-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n\t\t\tfont-size: 16px;\t\t\t\t\t\t\n\t\t\tcolor: #FAFAFA;\n\t\t\tbackground-color: rgba(0, 0, 0, 0.8);\n\t\t\tbackdrop-filter: blur(10px);\t\t\n\t\t}\n\t\t#hc-container {\t\t\t\t\t\t\t\t\t\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\t\t\n\t\t\tdisplay: flex;\t\t\n\t\t\ttext-align: center;\n\t\t\tflex-direction: column;\n\t\t\tjustify-content: center;\n\t\t\talign-items: center;\n\t\t}\n\t\t#hc-group {\t\t\t\n\t\t\tmax-width: 50%;\n\t\t\tbackground-color: rgba(0, 21, 90, 0.8);\n\t\t\tpadding: 20px;\n\t\t\tborder-radius: 5px;\n\t\t}\n\t\t#hc-container p{\n\t\t\tfont-weight: normal;\n\t\t\ttext-decoration: none;\t\t\t\n\t\t\tfont-size: 1rem;\n\t\t\tline-height: 1.6rem;\n\t\t}\t\t\n\t\t#hc-container input{\n\t\t\tfont-weight: normal;\n\t\t\ttext-decoration: none;\t\t\t\t\n\t\t\tfont-size: 0.9rem;\n\t\t\toutline: none;\n\t\t\tborder: none;\n\t\t\tbackground-color: white;\n\t\t}\n\t\t#hc-container button{\t\n\t\t\tcursor: pointer;\n\t\t\tbackground-color: #5a5a5a;\t\t\t\t\t\t\t\t\n\t\t\tpadding: 5px;\n\t\t\tborder-radius: 3px;\n\t\t\ttransition: transform 1s;\n\t\t\toutline: none;\n\t\t\tborder: none;\n\t\t}\n\t\t#hc-container button:hover{\t\n\t\t\ttransform: scale(1.2);\n\t\t\tbackground-color: #474747;\t\n\t\t}\n\t\t.hc-horizontal{\n\t\t\twidth: 90%;\n\t\t\tdisplay: inline-flex;\n\t\t\talign-items: center;\n\t\t\tjustify-content: space-between;\n\t\t\tgap: 2px;\t\t\t\n\t\t\tbackground-color: white;\n\t\t\tpadding: 5px;\n\t\t\tborder-radius: 5px;\n\t\t}\n\t",document.head.append(t)}function lockedUIHTML(){const t=document.createElement("div");return t.setAttribute("id","hc-lockedmain"),t.innerHTML='\t\n\t\t<div id="hc-container">\n\t\t\t<div id="hc-group">\n\t\t\t\t<p>This chat is protected by <strong>Hide Chat</strong></p>\t\t\t\n\t\t\t\t<div class="hc-horizontal">\n\t\t\t\t\t<input type="password" id="hc-lockedpass" placeholder="Input password" maxlength="126" autocomplete="off">\n\t\t\t\t\t<button id="hc-unlockpass">\n\t\t\t\t\t\t<svg xmlns="http://www.w3.org/2000/svg" height="16px" viewBox="0 -960 960 960" width="16px" fill="#FAFAFA"><path d="M240-640h360v-80q0-50-35-85t-85-35q-50 0-85 35t-35 85h-80q0-83 58.5-141.5T480-920q83 0 141.5 58.5T680-720v80h40q33 0 56.5 23.5T800-560v400q0 33-23.5 56.5T720-80H240q-33 0-56.5-23.5T160-160v-400q0-33 23.5-56.5T240-640Zm0 480h480v-400H240v400Zm240-120q33 0 56.5-23.5T560-360q0-33-23.5-56.5T480-440q-33 0-56.5 23.5T400-360q0 33 23.5 56.5T480-280ZM240-160v-400 400Z"/></svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t',t}